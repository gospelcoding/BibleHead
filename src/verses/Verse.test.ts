import {newVerse, verseStrength} from './Verse';

test('Verse Strength', () => {
  const baseVerse = {
    ...newVerse({
      text: '',
      bookId: 1,
      bookName: '',
      startChapter: 1,
    }),
    learned: true,
  };
  const lastReviews = [
    undefined,
    ...[0, 1, 2, 3, 10, 15, 30, 60].map(lastReviewFromAge),
  ];
  const successfulReviewses = [0, 1, 2, 5, 10, 15];
  const vals = successfulReviewses.map((successfulReviews) =>
    lastReviews.map((lastReview) =>
      verseStrength({...baseVerse, successfulReviews, lastReview}),
    ),
  );
  expect(vals).toEqual([
    [0, 0, 0, 0, 0, 0, 0, 0, 0],
    [
      20,
      19.999999997685187,
      19.799999997685184,
      19.599999997685185,
      19.399999997685185,
      17.999999997685187,
      16.999999997685183,
      13.999999997685187,
      7.999999997685185,
    ],
    [
      33.33333333333333,
      33.3333333294753,
      32.99999999614197,
      32.66666666280864,
      32.3333333294753,
      29.999999996141973,
      28.333333329475302,
      23.33333332947531,
      13.333333329475307,
    ],
    [
      55.55555555555556,
      55.555555549125515,
      54.99999999356996,
      54.4444444380144,
      53.88888888245885,
      49.99999999356996,
      47.22222221579218,
      38.88888888245885,
      22.222222215792183,
    ],
    [
      71.42857142857143,
      71.42857142030424,
      70.71428570601852,
      69.9999999917328,
      69.28571427744708,
      64.2857142774471,
      60.714285706018515,
      49.99999999173281,
      28.571428563161376,
    ],
    [
      78.94736842105263,
      78.9473684119152,
      78.15789472770467,
      77.36842104349415,
      76.57894735928362,
      71.05263156980995,
      67.1052631487573,
      55.26315788559942,
      31.578947359283625,
    ],
  ]);
});

function lastReviewFromAge(daysOld: number) {
  return Date.now() - daysOld * 24 * 60 * 60 * 1000;
}
